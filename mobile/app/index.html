<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#1a1a2e">
  <title>Alpaca Playhouse</title>

  <!-- Supabase JS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <!-- HLS.js for camera streams -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.7/dist/hls.min.js"></script>

  <link rel="stylesheet" href="mobile.css">
</head>
<body>

  <!-- ======================================= -->
  <!-- LOADING OVERLAY                          -->
  <!-- ======================================= -->
  <div id="loadingOverlay" class="m-loading-overlay">
    <div class="m-loading-spinner"></div>
    <div class="m-loading-text">Loading...</div>
  </div>

  <!-- ======================================= -->
  <!-- UNAUTHORIZED OVERLAY                     -->
  <!-- ======================================= -->
  <div id="unauthorizedOverlay" class="m-unauthorized-overlay hidden">
    <div class="m-unauthorized-card">
      <h2>Access Denied</h2>
      <p>Your account does not have resident access.</p>
      <button id="signOutBtn" class="m-btn m-btn--primary">Sign Out</button>
    </div>
  </div>

  <!-- ======================================= -->
  <!-- APP CONTENT (hidden until auth)          -->
  <!-- ======================================= -->
  <div id="appContent" class="m-app hidden">

    <!-- Top bar -->
    <header class="m-header">
      <span class="m-header__title">Alpaca Playhouse</span>
      <div class="m-header__right">
        <span id="userInfo" class="m-header__user"></span>
      </div>
    </header>

    <!-- Tab content sections -->
    <main class="m-main">

      <!-- CAMERAS TAB -->
      <section id="tab-cameras" class="m-tab-content active">
        <div id="camerasContent" class="m-tab-body">
          <div class="m-loading-inline">Loading cameras...</div>
        </div>
      </section>

      <!-- MUSIC TAB -->
      <section id="tab-music" class="m-tab-content">
        <div id="musicContent" class="m-tab-body">
          <div class="m-loading-inline">Loading music...</div>
        </div>
      </section>

      <!-- LIGHTS TAB -->
      <section id="tab-lights" class="m-tab-content">
        <div id="lightsContent" class="m-tab-body">
          <div class="m-loading-inline">Loading lights...</div>
        </div>
      </section>

      <!-- CLIMATE TAB -->
      <section id="tab-climate" class="m-tab-content">
        <div id="climateContent" class="m-tab-body">
          <div class="m-loading-inline">Loading climate...</div>
        </div>
      </section>

      <!-- CARS TAB -->
      <section id="tab-cars" class="m-tab-content">
        <div id="carsContent" class="m-tab-body">
          <div class="m-loading-inline">Loading vehicles...</div>
        </div>
      </section>

    </main>

    <!-- Bottom tab bar -->
    <nav class="m-tab-bar" id="tabBar">
      <button class="m-tab-btn active" data-tab="cameras">
        <svg class="m-tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/><circle cx="12" cy="13" r="4"/></svg>
        <span class="m-tab-label">Cameras</span>
      </button>
      <button class="m-tab-btn" data-tab="music">
        <svg class="m-tab-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
        <span class="m-tab-label">Music</span>
      </button>
      <button class="m-tab-btn" data-tab="lights">
        <svg class="m-tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21h6M12 3a6 6 0 00-4 10.5V17h8v-3.5A6 6 0 0012 3z"/></svg>
        <span class="m-tab-label">Lights</span>
      </button>
      <button class="m-tab-btn" data-tab="climate">
        <svg class="m-tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 14.76V3.5a2.5 2.5 0 00-5 0v11.26a4.5 4.5 0 105 0z"/></svg>
        <span class="m-tab-label">Climate</span>
      </button>
      <button class="m-tab-btn" data-tab="cars" id="carsTabBtn">
        <svg class="m-tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 17h14M7.5 17a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM16.5 17a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"/><path d="M5 12l1.5-4.5h11L19 12"/></svg>
        <span class="m-tab-label">Cars</span>
      </button>
    </nav>

  </div>

  <!-- App logic -->
  <script type="module" src="mobile-app.js"></script>

</body>
</html>
